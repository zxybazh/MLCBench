MLCBench
---
Benchmark scripts for both dynamic and static workloads inside Relax model, including PrimFuncs & Library Offloads.\
Relax commit: `6fd55bcfecc7abcc707339d7a8ba493f0048b613`\
Relax branch: https://github.com/mlc-ai/relax.git

Example benchmarking results for relax func "decoding":
```
      Time(us) Weight   WxTime(ms)               PrimFuncs in encoding                              InputInfo(n=64, m=32)
0        0.110      1     0.000110                             reshape  R.Tensor((1, n), dtype="int32"), R.Tensor((n,)...
1       19.571      1     0.019571                                take  R.Tensor((32000, 4096), dtype="float16"), R.Te...
2       18.341      1     0.018341                            reshape1  R.Tensor((n, 4096), dtype="float16"), R.Tensor...
3        2.660      1     0.002660  fused_min_max_triu_te_broadcast_to  R.Shape([n]), R.Tensor((1, 1, n, n), dtype="fl...
4        1.540      1     0.001540                           extend_te  R.Tensor((1, 1, n, n), dtype="float16"), R.Ten...
5     4549.855     65   295.740575                            rms_norm  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
6       19.320     96     1.854720                            reshape2  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
7    12354.108     64   790.662912                    rotary_embedding  R.Tensor((1, n, 32, 128), dtype="float16"), R....
8       18.500     64     1.184000                             squeeze  R.Tensor((1, n, 32, 128), dtype="float16"), R....
9        7.200     64     0.460800                            reshape3  R.Tensor((m, 32, 128), dtype="float16"), R.Ten...
10      23.830     32     0.762560                           transpose  R.Tensor((1, n, 32, 128), dtype="float16"), R....
11       8.940     64     0.572160                           transpose  R.Tensor((1, m, 32, 128), dtype="float16"), R....
12    1636.955     32    52.382560                    fused_divide_add  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
13    4985.226     32   159.527232                             softmax  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
14  251908.206     32  8061.062592                              matmul  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
15      22.010     32     0.704320                          transpose1  R.Tensor((1, 32, n, 128), dtype="float16"), R....
16      18.991     32     0.607712                            reshape4  R.Tensor((1, n, 32, 128), dtype="float16"), R....
17   60873.017     32  1947.936544                 fused_silu_multiply  R.Tensor((1, n, 11008), dtype="float16"), R.Te...
18       0.210      1     0.000210                               slice  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
19      64.711      1     0.064711                                cast  R.Tensor((1, 1, 32000), dtype="float16"), R.Te...


      Time(us) Weight    WxTime(ms)               PrimFuncs in encoding                             InputInfo(n=16, m=512)
0        0.110      1      0.000110                             reshape  R.Tensor((1, n), dtype="int32"), R.Tensor((n,)...
1        2.850      1      0.002850                                take  R.Tensor((32000, 4096), dtype="float16"), R.Te...
2        3.210      1      0.003210                            reshape1  R.Tensor((n, 4096), dtype="float16"), R.Tensor...
3        0.420      1      0.000420  fused_min_max_triu_te_broadcast_to  R.Shape([n]), R.Tensor((1, 1, n, n), dtype="fl...
4        4.880      1      0.004880                           extend_te  R.Tensor((1, 1, n, n), dtype="float16"), R.Ten...
5     1099.226     65     71.449690                            rms_norm  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
6        2.870     96      0.275520                            reshape2  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
7     3084.196     64    197.388544                    rotary_embedding  R.Tensor((1, n, 32, 128), dtype="float16"), R....
8        2.901     64      0.185664                             squeeze  R.Tensor((1, n, 32, 128), dtype="float16"), R....
9      185.623     64     11.879872                            reshape3  R.Tensor((m, 32, 128), dtype="float16"), R.Ten...
10       3.040     32      0.097280                           transpose  R.Tensor((1, n, 32, 128), dtype="float16"), R....
11     252.094     64     16.134016                           transpose  R.Tensor((1, m, 32, 128), dtype="float16"), R....
12    6389.034     32    204.449088                    fused_divide_add  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
13   19199.064     32    614.370048                             softmax  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
14  992903.683     32  31772.917856                              matmul  R.Tensor((1, 32, n, m), dtype="float16"), R.Te...
15       3.380     32      0.108160                          transpose1  R.Tensor((1, 32, n, 128), dtype="float16"), R....
16       3.040     32      0.097280                            reshape4  R.Tensor((1, n, 32, 128), dtype="float16"), R....
17   15166.705     32    485.334560                 fused_silu_multiply  R.Tensor((1, n, 11008), dtype="float16"), R.Te...
18       0.210      1      0.000210                               slice  R.Tensor((1, n, 4096), dtype="float16"), R.Ten...
19      65.011      1      0.065011                                cast  R.Tensor((1, 1, 32000), dtype="float16"), R.Te...
```
